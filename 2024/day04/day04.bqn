in←>•FLines"input"

a←⌽∘⍉⍟(↕4)in
UpperDiags←{(⌽1+↕≠𝕩)↑¨<˘⍉(↕∘≠⌽˘⊢)𝕩}
d←∾1⊸↓¨∾¨⌽⍟0‿1¨¨UpperDiags¨a
na←+´+´∘⥊¨"XMAS"⊸⍷¨a
nd←+´+´¨"XMAS"⊸⍷¨d
•Show na+nd

idxs←(⥊↕¯2+≢in)+⌜↕3‿3
Diags←0‿0⊸⍉¨ ⌽∘⍉⍟0‿1
•Show +´{∧´(Diags𝕩⊑in)∊"MAS"‿"SAM"}˘idxs
