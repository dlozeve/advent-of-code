inâ†>â€¢FLines"input"
mapâ†'#'=in
iâ€¿jâ†âŠ‘Â¨/Â¨(âˆ¨Â´Ë˜â‹ˆâˆ¨Ë)'^'=in

Moveâ†{ğ•Šmapâ€¿iâ€¿jâ€¿v:
  pâ†âŒ½/iâ†‘jâŠË˜map
  newiâ†{0<â‰ p ? 1+âŠ‘p ; Â¯1}
  vâ†©1Â¨âŒ¾((âˆ¾âŸœjÂ¨1+newi+â†•i-newi)âŠ¸âŠ‘)v
  âŸ¨âŒ½âˆ˜â‰map,(â‰ map)-j+1,newi,âŒ½âˆ˜â‰vâŸ©
}
â€¢Show +Â´â¥Š3âŠ‘Moveâ€¢_while_(0â‰¤2âŠ¸âŠ‘)âŸ¨map,i,j,(â‰¢map)â¥Š0âŸ©

candidatesâ†â‰¢âŸœiâ€¿jÂ¨âŠ¸/â¥Šâ†•â‰¢map
Stopâ†{ğ•Šmapâ€¿iâ€¿jâ€¿v: ((iâ€¿jâŠ‘v)âˆ§(Â¬âŸ¨i-1,jâŸ©âŠ‘v)âˆ¨(Â¬âŸ¨i+1,jâŸ©âŠ‘v))âˆ¨j<0}
â€¢Show +Â´{0â‰¤2âŠ‘Moveâ€¢_while_(Â¬Stop)âŸ¨1âŒ¾(ğ•©âŠ¸âŠ‘)map,i,j,(â‰¢map)â¥Š0âŸ©}Â¨candidates
