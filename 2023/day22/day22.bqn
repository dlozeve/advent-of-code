âŸ¨SplitâŸ©â†â€¢Import"../bqn-libs/strings.bqn"
â‰ bricksâ†â‹âˆ˜(2âŠ¸âŠ‘Â¨âŒŠËÂ¨)âŠ¸âŠ>Â¨â€¢ParseFloatÂ¨Â¨Â¨","âŠ¸SplitÂ¨Â¨"~"âŠ¸SplitÂ¨â€¢FLines"test"

xmaxâ€¿ymaxâ€¿zmaxâ†1+âŒˆËâˆ¾Â´bricks
hâ†xmaxâ€¿ymaxâ¥Š0
segsâ†{(âŠğ•©)âŠ¸+Â¨â¥Šâ†•1+-ËœËğ•©}Â¨2âŠ¸â†‘Ë˜Â¨bricks
zsâ†1+2âŠ¸âŠ‘Â¨(âŒˆË-âŒŠË)Â¨bricks
h{segsâ€¿zsğ•Šğ•©: zsâŠ¸+âŒ¾(segsâŠ¸âŠ‘)ğ•©}Â´segsâ‹ˆÂ¨zs


Coveredâ†âˆ§Â´âˆ˜(2âŠ¸â†‘Ë˜âŠ¸(âŠâŠ¸â‰¤âˆ§1âŠ¸âŠâŠ¸â‰¥))
esâ†âˆ¾Â¯2âŠ¸â†‘Â¨Â¨2âŠ¸â†“Â¨â†‘Â¨â¥Š/Â¨{CoveredâŸœğ•©Â¨bricks}Â¨â†•xmaxâ€¿ymax
aâ†1Ë™Â¨âŒ¾(esâŠ¸âŠ‘)(âˆ¾Ëœâ‰ bricks)â¥Š0

Fallâ†{ğ•Šbricks:
  newzâ†{1+0âŒˆÂ´ğ•©/2âŠ¸âŠ‘Â¨âŒˆËÂ¨bricks}Â¨<Ë˜â‰a
  {ğ•©+newz-2âŠ¸âŠ‘Â¨âŒŠËÂ¨bricks}âŒ¾(2âŠ¸âŠË˜Â¨)bricks
}
#fallenbricksâ†FallâŸzmax bricks
fallenbricksâ†Fall{ğ•Šâˆ˜âŠ¢âŸâ‰¢âŸœğ”½ğ•©} bricks
es2â†{1=|-Â´2âŠ¸âŠ‘Â¨âŸ¨âŒˆË,âŒŠËâŸ©{ğ•ğ•©}Â¨ğ•©âŠfallenbricks}Â¨âŠ¸/es
bâ†1Ë™Â¨âŒ¾(es2âŠ¸âŠ‘)(âˆ¾Ëœâ‰ bricks)â¥Š0
+Â´0=+Ë(1â‰¥+Ëb)/â‰b
